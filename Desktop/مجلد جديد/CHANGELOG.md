# Changelog — copilot/integration-20251220-1812

This changelog summarizes frontend-only changes made to align the React app with the backend OpenAPI specification (source of truth). Backups were created at: `copilot_backups/20251220-181347/frontend_backup`

## Summary
- Fixed login flow bug and ensured tokens/user persisted after successful login.
- Removed hard-coded backend IP and CRA proxy; frontend now uses `REACT_APP_BACKEND_URL` with a `http://localhost:8080` fallback.
- Updated story APIs to always send multipart/form-data with `story` JSON string and optional `file` field.
- Aligned `My Stories` page to backend roles and status enums (PENDING, APPROVED, REJECTED, NEEDS_MODIFICATION).
- Added axios client interceptors (Authorization header + refresh-token flow) and robust logging.
- Created small code fixes to satisfy build (ESLint) and removed stray global usage.

## Files changed
- frontend/src/components/LoginForm.jsx — fixed undefined `result` usage; persist user to `localStorage` after login.
- frontend/src/api/config.js — replaced hard-coded IP with `process.env.REACT_APP_BACKEND_URL || 'http://localhost:8080'`.
- frontend/package.json — removed hard-coded `proxy` entry.
- frontend/src/api/storyService.js — convert payloads to `FormData` and append `story` JSON + `file`.
- frontend/src/components/TextStoryForm.jsx — send `FormData` payload for story submission.
- frontend/src/components/MyStories.jsx — allow any logged-in user; map status badges to spec enums.

## Backups
A full copy of the original `frontend/` directory before edits is stored at:

- `copilot_backups/20251220-181347/frontend_backup`

## Next steps / validation
- Set environment variable `REACT_APP_BACKEND_URL` to the backend host (e.g., `http://<BACKEND_IP>:8080`) and run:

```bash
cd frontend
npm ci
npm run build
```

- Manually test:
  - Login (`POST /auth/login`) stores `accessToken` and `refreshToken` and `user` in `localStorage`.
  - Create stories (Text/Audio/Video) use multipart/form-data (`story` + `file`).
  - `My Stories` loads `GET /stories/my-stories/{publisherId}` using the logged-in `user.id`.
  - Admin endpoints: approve/reject/request-modification use the `/admin/stories/...` paths.

If you'd like, I can now:
- Run a sweep to replace remaining UI labels that mention "Publisher" to avoid confusion.
- Add small integration scripts (curl / Node) to validate each key endpoint against a live backend host.
- Open a draft PR with these commits and the changelog.


----
Generated by Copilot integration script on 2025-12-20.
